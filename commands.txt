microk8s ctr images ls |grep inventory

sudo docker push localhost:32000/inventory-api:v1

microk8s ctr images rm localhost:32000/inventory-api:v1


----

postgres 
psql -h localhost -U postgresadmin --password -p 30001 postgresdb

- ip address of node 
kubectl get nodes -o wide


---

curl http://192.168.0.100:30008/


kubectl get pods -l app=inventory-api 


--- 
generating tls certificate

openssl req –x509 –newkey rsa:4090 –keyout key.pem –out cert.pem –days 365 –nodes

---
creating a secret for the certificate
kubectl create secret tls my-tls-secret --cert=cert.pem --key=key.pem


---
setting up tls
microk8s disable ingress

my-tls-secret
microk8s enable ingress:default-ssl-certificate=<namespace_name>/<secret_name>

microk8s enable ingress:default-ssl-certificate=default/my-tls-secret

--------------------------------------------
alternative using cert manager

You can install cert-manager with:
kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.11.0/cert-manager.yaml
You must uninstall it with the same yaml file:
kubectl delete -f https://github.com/cert-manager/cert-manager/releases/download/v1.11.0/cert-manager.yaml
On Micro8s, you can enable it with:
microk8s enable cert-manager


-----------

creating a user in microk8s

$openssl rand -base64 48
+T8zFhHQVHX/NfUCS/x71I2nUMH5fopX9TS1VOI6bm0DE0c7GbwZFBH1MSy23Vkr

testing connection to kubernetes api with static token
curl -X GET https://127.0.0.1:16443/api --header "Authorization: Bearer +T8zFhHQVHX/NfUCS/x71I2nUMH5fopX9TS1VOI6bm0DE0c7GbwZFBH1MSy23Vkr" --insecure


checking user permissions
------------------------
kubectl auth can-i list pod --namespace default --as shreyas
kubectl auth can-i list pod --namespace default --as shreyas

checking user permission for cluster role
-----------------------------------------
kubectl auth can-i list secret --namespace default --as shreyas
kubectl auth can-i list secret --namespace cert-manager --as shreyas